[1;32mamazon-ebs output will be in this color.[0m

[1;32m==> amazon-ebs: Inspecting the source AMI...[0m
[1;32m==> amazon-ebs: Creating temporary keypair: packer 550a176c-82e8-0352-d57a-995b6fbab3c1[0m
[1;32m==> amazon-ebs: Creating temporary security group for this instance...[0m
[1;32m==> amazon-ebs: Authorizing SSH access on the temporary security group...[0m
[1;32m==> amazon-ebs: Launching a source AWS instance...[0m
[0;32m    amazon-ebs: Instance ID: i-a9622959[0m
[1;32m==> amazon-ebs: Waiting for instance (i-a9622959) to become ready...[0m
[1;32m==> amazon-ebs: Waiting for SSH to become available...[0m
[1;32m==> amazon-ebs: Connected to SSH![0m
[1;32m==> amazon-ebs: Provisioning with chef-solo[0m
[0;32m    amazon-ebs: Installing Chef...[0m
[0;32m    amazon-ebs: % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current[0m
[0;32m    amazon-ebs: Dload  Upload   Total   Spent    Left  Speed[0m
[0;32m    amazon-ebs: 100 18378  100 18378    0     0  45105      0 --:--:-- --:--:-- --:--:-- 45154[0m
[0;32m    amazon-ebs: Downloading Chef  for ubuntu...[0m
[0;32m    amazon-ebs: downloading https://www.opscode.com/chef/metadata?v=&prerelease=false&nightlies=false&p=ubuntu&pv=14.04&m=x86_64[0m
[0;32m    amazon-ebs: to file /tmp/install.sh.1250/metadata.txt[0m
[0;32m    amazon-ebs: trying wget...[0m
[0;32m    amazon-ebs: url	https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/13.04/x86_64/chef_12.1.1-1_amd64.deb[0m
[0;32m    amazon-ebs: md5	028e2335ff309fa4555ed0dfd486162f[0m
[0;32m    amazon-ebs: sha256	108bc8a1786b1a4cfbb42dcea0e4990221340aae669878df3f67fffe1fb1ad24[0m
[0;32m    amazon-ebs: downloaded metadata file looks valid...[0m
[0;32m    amazon-ebs: downloading https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/13.04/x86_64/chef_12.1.1-1_amd64.deb[0m
[0;32m    amazon-ebs: to file /tmp/install.sh.1250/chef_12.1.1-1_amd64.deb[0m
[0;32m    amazon-ebs: trying wget...[0m
[0;32m    amazon-ebs: Comparing checksum with sha256sum...[0m
[0;32m    amazon-ebs: Installing Chef[0m
[0;32m    amazon-ebs: installing with dpkg...[0m
[0;32m    amazon-ebs: Selecting previously unselected package chef.[0m
[0;32m    amazon-ebs: (Reading database ... 51117 files and directories currently installed.)[0m
[0;32m    amazon-ebs: Preparing to unpack .../chef_12.1.1-1_amd64.deb ...[0m
[0;32m    amazon-ebs: Unpacking chef (12.1.1-1) ...[0m
[0;32m    amazon-ebs: Setting up chef (12.1.1-1) ...[0m
[0;32m    amazon-ebs: Thank you for installing Chef![0m
[0;32m    amazon-ebs: Creating directory: /tmp/packer-chef-solo[0m
[0;32m    amazon-ebs: Creating directory: /tmp/packer-chef-solo/cookbooks-0[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: Creating directory: /tmp/packer-chef-solo/data_bags[0m
[0;32m    amazon-ebs: Creating configuration file 'solo.rb'[0m
[0;32m    amazon-ebs: Creating JSON attribute file[0m
[0;32m    amazon-ebs: Executing Chef: sudo chef-solo --no-color -c /tmp/packer-chef-solo/solo.rb -j /tmp/packer-chef-solo/node.json[0m
[0;32m    amazon-ebs: Starting Chef Client, version 12.1.1[0m
[0;32m    amazon-ebs: Compiling Cookbooks...[0m
[0;32m    amazon-ebs: Converging 11 resources[0m
[0;32m    amazon-ebs: Recipe: java::openjdk[0m
[0;32m    amazon-ebs: * apt_package[openjdk-6-jdk] action install[0m
[0;32m    amazon-ebs: - install version 6b34-1.13.6-1ubuntu0.14.04.1 of package openjdk-6-jdk[0m
[0;32m    amazon-ebs: * apt_package[openjdk-6-jre-headless] action install (up to date)[0m
[0;32m    amazon-ebs: * java_alternatives[set-java-alternatives] action set[0m
[0;32m    amazon-ebs: - Add alternative for apt[0m
[0;32m    amazon-ebs: - Add alternative for java[0m
[0;32m    amazon-ebs: - Set alternative for java[0m
[0;32m    amazon-ebs: - Add alternative for javaws[0m
[0;32m    amazon-ebs: - Set alternative for javaws[0m
[0;32m    amazon-ebs: - Add alternative for keytool[0m
[0;32m    amazon-ebs: - Set alternative for keytool[0m
[0;32m    amazon-ebs: - Add alternative for orbd[0m
[0;32m    amazon-ebs: - Set alternative for orbd[0m
[0;32m    amazon-ebs: - Add alternative for pack200[0m
[0;32m    amazon-ebs: - Set alternative for pack200[0m
[0;32m    amazon-ebs: - Add alternative for policytool[0m
[0;32m    amazon-ebs: - Set alternative for policytool[0m
[0;32m    amazon-ebs: - Add alternative for rmid[0m
[0;32m    amazon-ebs: - Set alternative for rmid[0m
[0;32m    amazon-ebs: - Add alternative for rmiregistry[0m
[0;32m    amazon-ebs: - Set alternative for rmiregistry[0m
[0;32m    amazon-ebs: - Add alternative for servertool[0m
[0;32m    amazon-ebs: - Set alternative for servertool[0m
[0;32m    amazon-ebs: - Add alternative for tnameserv[0m
[0;32m    amazon-ebs: - Set alternative for tnameserv[0m
[0;32m    amazon-ebs: - Add alternative for unpack200[0m
[0;32m    amazon-ebs: - Set alternative for unpack200[0m
[0;32m    amazon-ebs: Recipe: java::default_java_symlink[0m
[0;32m    amazon-ebs: * link[/usr/lib/jvm/default-java] action create[0m
[0;32m    amazon-ebs: - create symlink at /usr/lib/jvm/default-java to /usr/lib/jvm/java-6-openjdk-amd64[0m
[0;32m    amazon-ebs: Recipe: java::set_java_home[0m
[0;32m    amazon-ebs: * ruby_block[set-env-java-home] action run[0m
[0;32m    amazon-ebs: - execute the ruby block set-env-java-home[0m
[0;32m    amazon-ebs: * directory[/etc/profile.d] action create (up to date)[0m
[0;32m    amazon-ebs: * file[/etc/profile.d/jdk.sh] action create[0m
[0;32m    amazon-ebs: - create new file /etc/profile.d/jdk.sh[0m
[0;32m    amazon-ebs: - update content in file /etc/profile.d/jdk.sh from none to 37eba7[0m
[0;32m    amazon-ebs: --- /etc/profile.d/jdk.sh	2015-03-19 00:29:05.777476000 +0000[0m
[0;32m    amazon-ebs: +++ /etc/profile.d/.jdk.sh20150319-1354-1vhle79	2015-03-19 00:29:05.777476000 +0000[0m
[0;32m    amazon-ebs: @@ -1 +1,2 @@[0m
[0;32m    amazon-ebs: +export JAVA_HOME=/usr/lib/jvm/java-6-openjdk-amd64[0m
[0;32m    amazon-ebs: - change mode from '' to '0755'[0m
[0;32m    amazon-ebs: Recipe: tomcat::default[0m
[0;32m    amazon-ebs: * apt_package[tomcat7] action install[0m
[0;32m    amazon-ebs: - install version 7.0.52-1ubuntu0.1 of package tomcat7[0m
[0;32m    amazon-ebs: * apt_package[tomcat7-admin] action install[0m
[0;32m    amazon-ebs: - install version 7.0.52-1ubuntu0.1 of package tomcat7-admin[0m
[0;32m    amazon-ebs: * tomcat_instance[base] action configure (up to date)[0m
[0;32m    amazon-ebs: * directory[/usr/share/tomcat7/lib/endorsed] action create[0m
[0;32m    amazon-ebs: - create new directory /usr/share/tomcat7/lib/endorsed[0m
[0;32m    amazon-ebs: - change mode from '' to '0755'[0m
[0;32m    amazon-ebs: * template[/etc/default/tomcat7] action create[0m
[0;32m    amazon-ebs: - update content in file /etc/default/tomcat7 from 3f5a92 to 9faef0[0m
[0;32m    amazon-ebs: --- /etc/default/tomcat7	2015-03-19 00:29:15.142156000 +0000[0m
[0;32m    amazon-ebs: +++ /tmp/chef-rendered-template20150319-1354-1kxemes	2015-03-19 00:29:28.456809999 +0000[0m
[0;32m    amazon-ebs: @@ -1,25 +1,44 @@[0m
[0;32m    amazon-ebs: +#[0m
[0;32m    amazon-ebs: +# Dynamically generated by Chef on ip-10-28-214-220.ec2.internal[0m
[0;32m    amazon-ebs: +#[0m
[0;32m    amazon-ebs: +# Local modifications will be overwritten by Chef.[0m
[0;32m    amazon-ebs: +#[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: # Run Tomcat as this user ID. Not setting this or leaving it blank will use the[0m
[0;32m    amazon-ebs: -# default of tomcat7.[0m
[0;32m    amazon-ebs: -TOMCAT7_USER=tomcat7[0m
[0;32m    amazon-ebs: +# default of tomcat6.[0m
[0;32m    amazon-ebs: +TOMCAT7_USER=root[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: # Run Tomcat as this group ID. Not setting this or leaving it blank will use[0m
[0;32m    amazon-ebs: -# the default of tomcat7.[0m
[0;32m    amazon-ebs: +# the default of tomcat6.[0m
[0;32m    amazon-ebs: TOMCAT7_GROUP=tomcat7[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: # The home directory of the Java development kit (JDK). You need at least[0m
[0;32m    amazon-ebs: -# JDK version 1.5. If JAVA_HOME is not set, some common directories for[0m
[0;32m    amazon-ebs: +# JDK version 1.5. If JAVA_HOME is not set, some common directories for[0m
[0;32m    amazon-ebs: # OpenJDK, the Sun JDK, and various J2SE 1.5 versions are tried.[0m
[0;32m    amazon-ebs: -#JAVA_HOME=/usr/lib/jvm/openjdk-6-jdk[0m
[0;32m    amazon-ebs: +JAVA_HOME=/usr/lib/jvm/java-6-openjdk-amd64[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: +# Directory where the Tomcat 6 binary distribution resides.  This a read-only[0m
[0;32m    amazon-ebs: +# directory that can be shared by all Tomcat instances running on the machine.[0m
[0;32m    amazon-ebs: +# Default: /usr/share/tomcat6[0m
[0;32m    amazon-ebs: +CATALINA_HOME=/usr/share/tomcat7[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: +# Directory for per-instance configuration files and webapps. It contains the[0m
[0;32m    amazon-ebs: +# directories conf, logs, webapps, work and temp. See RUNNING.txt for details.[0m
[0;32m    amazon-ebs: +# Default: /var/lib/tomcat6[0m
[0;32m    amazon-ebs: +CATALINA_BASE=/var/lib/tomcat7[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: # You may pass JVM startup parameters to Java here. If unset, the default[0m
[0;32m    amazon-ebs: -# options will be: -Djava.awt.headless=true -Xmx128m -XX:+UseConcMarkSweepGC[0m
[0;32m    amazon-ebs: -#[0m
[0;32m    amazon-ebs: -# Use "-XX:+UseConcMarkSweepGC" to enable the CMS garbage collector (improved[0m
[0;32m    amazon-ebs: -# response time). If you use that option and you run Tomcat on a machine with[0m
[0;32m    amazon-ebs: -# exactly one CPU chip that contains one or two cores, you should also add[0m
[0;32m    amazon-ebs: -# the "-XX:+CMSIncrementalMode" option.[0m
[0;32m    amazon-ebs: -JAVA_OPTS="-Djava.awt.headless=true -Xmx128m -XX:+UseConcMarkSweepGC"[0m
[0;32m    amazon-ebs: +# options (-Djava.awt.headless=true -Xmx128m) will be used.[0m
[0;32m    amazon-ebs: +JAVA_OPTS="-Xmx128M -Djava.awt.headless=true"[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: +# Use a CMS garbage collector for improved response time[0m
[0;32m    amazon-ebs: +JAVA_OPTS="${JAVA_OPTS} -XX:+UseConcMarkSweepGC"[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: +# When using the CMS garbage collector, you should enable the following option[0m
[0;32m    amazon-ebs: +# if you run Tomcat on a machine with exactly one CPU chip that contains one[0m
[0;32m    amazon-ebs: +# or two cores.[0m
[0;32m    amazon-ebs: +#JAVA_OPTS="$JAVA_OPTS -XX:+CMSIncrementalMode"[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: # To enable remote debugging uncomment the following line.[0m
[0;32m    amazon-ebs: # You will then be able to use a java debugger on port 8000.[0m
[0;32m    amazon-ebs: #JAVA_OPTS="${JAVA_OPTS} -Xdebug -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=n"[0m
[0;32m    amazon-ebs: @@ -29,20 +48,24 @@[0m
[0;32m    amazon-ebs: #JSP_COMPILER=javac[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: # Use the Java security manager? (yes/no, default: no)[0m
[0;32m    amazon-ebs: -#TOMCAT7_SECURITY=no[0m
[0;32m    amazon-ebs: +TOMCAT7_SECURITY=no[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: -# Number of days to keep logfiles in /var/log/tomcat7. Default is 14 days.[0m
[0;32m    amazon-ebs: +# Number of days to keep logfiles in /var/log/tomcat6. Default is 14 days.[0m
[0;32m    amazon-ebs: #LOGFILE_DAYS=14[0m
[0;32m    amazon-ebs: -# Whether to compress logfiles older than today's[0m
[0;32m    amazon-ebs: -#LOGFILE_COMPRESS=1[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: # Location of the JVM temporary directory[0m
[0;32m    amazon-ebs: # WARNING: This directory will be destroyed and recreated at every startup ![0m
[0;32m    amazon-ebs: -#JVM_TMP=/tmp/tomcat7-temp[0m
[0;32m    amazon-ebs: +JVM_TMP=/tmp/tomcat7-tmp[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: # If you run Tomcat on port numbers that are all higher than 1023, then you[0m
[0;32m    amazon-ebs: # do not need authbind.  It is used for binding Tomcat to lower port numbers.[0m
[0;32m    amazon-ebs: # NOTE: authbind works only with IPv4.  Do not enable it when using IPv6.[0m
[0;32m    amazon-ebs: # (yes/no, default: no)[0m
[0;32m    amazon-ebs: -#AUTHBIND=no[0m
[0;32m    amazon-ebs: +AUTHBIND=no[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: +# JVM parameters passed only for start and run commands[0m
[0;32m    amazon-ebs: +CATALINA_OPTS=""[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: +# Endorse .jar files in this directory[0m
[0;32m    amazon-ebs: +JAVA_ENDORSED_DIRS="/usr/share/tomcat7/lib/endorsed"[0m
[0;32m    amazon-ebs: * template[/etc/tomcat7/server.xml] action create[0m
[0;32m    amazon-ebs: - update content in file /etc/tomcat7/server.xml from 285e80 to ec6e33[0m
[0;32m    amazon-ebs: --- /etc/tomcat7/server.xml	2014-07-24 20:38:48.000000000 +0000[0m
[0;32m    amazon-ebs: +++ /tmp/chef-rendered-template20150319-1354-1h8qbfg	2015-03-19 00:29:28.484823999 +0000[0m
[0;32m    amazon-ebs: @@ -1,5 +1,9 @@[0m
[0;32m    amazon-ebs: <?xml version='1.0' encoding='utf-8'?>[0m
[0;32m    amazon-ebs: <!--[0m
[0;32m    amazon-ebs: +  Dynamically generated by Chef on ip-10-28-214-220.ec2.internal[0m
[0;32m    amazon-ebs: +  Local modifications will be overwritten by Chef.[0m
[0;32m    amazon-ebs: +-->[0m
[0;32m    amazon-ebs: +<!--[0m
[0;32m    amazon-ebs: Licensed to the Apache Software Foundation (ASF) under one or more[0m
[0;32m    amazon-ebs: contributor license agreements.  See the NOTICE file distributed with[0m
[0;32m    amazon-ebs: this work for additional information regarding copyright ownership.[0m
[0;32m    amazon-ebs: @@ -20,9 +24,7 @@[0m
[0;32m    amazon-ebs: Documentation at /docs/config/server.html[0m
[0;32m    amazon-ebs: -->[0m
[0;32m    amazon-ebs: <Server port="8005" shutdown="SHUTDOWN">[0m
[0;32m    amazon-ebs: -  <!-- Security listener. Documentation at /docs/config/listeners.html[0m
[0;32m    amazon-ebs: -  <Listener className="org.apache.catalina.security.SecurityListener" />[0m
[0;32m    amazon-ebs: -  -->[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: <!--APR library loader. Documentation at /docs/apr.html -->[0m
[0;32m    amazon-ebs: <!--[0m
[0;32m    amazon-ebs: <Listener className="org.apache.catalina.core.AprLifecycleListener" SSLEngine="on" />[0m
[0;32m    amazon-ebs: @@ -32,7 +34,6 @@[0m
[0;32m    amazon-ebs: <!-- Prevent memory leaks due to use of particular java/javax APIs-->[0m
[0;32m    amazon-ebs: <Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener" />[0m
[0;32m    amazon-ebs: <Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener" />[0m
[0;32m    amazon-ebs: -  <Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener" />[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: <!-- Global JNDI resources[0m
[0;32m    amazon-ebs: Documentation at /docs/jndi-resources-howto.html[0m
[0;32m    amazon-ebs: @@ -61,7 +62,6 @@[0m
[0;32m    amazon-ebs: maxThreads="150" minSpareThreads="4"/>[0m
[0;32m    amazon-ebs: -->[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: -[0m
[0;32m    amazon-ebs: <!-- A "Connector" represents an endpoint by which requests are received[0m
[0;32m    amazon-ebs: and responses are returned. Documentation at :[0m
[0;32m    amazon-ebs: Java HTTP Connector: /docs/config/http.html (blocking & non-blocking)[0m
[0;32m    amazon-ebs: @@ -72,7 +72,8 @@[0m
[0;32m    amazon-ebs: <Connector port="8080" protocol="HTTP/1.1"[0m
[0;32m    amazon-ebs: connectionTimeout="20000"[0m
[0;32m    amazon-ebs: URIEncoding="UTF-8"[0m
[0;32m    amazon-ebs: -               redirectPort="8443" />[0m
[0;32m    amazon-ebs: +               redirectPort="8443"[0m
[0;32m    amazon-ebs: +             />[0m
[0;32m    amazon-ebs: <!-- A "Connector" using the shared thread pool-->[0m
[0;32m    amazon-ebs: <!--[0m
[0;32m    amazon-ebs: <Connector executor="tomcatThreadPool"[0m
[0;32m    amazon-ebs: @@ -84,18 +85,20 @@[0m
[0;32m    amazon-ebs: This connector uses the JSSE configuration, when using APR, the[0m
[0;32m    amazon-ebs: connector should be using the OpenSSL style configuration[0m
[0;32m    amazon-ebs: described in the APR documentation -->[0m
[0;32m    amazon-ebs: -    <!--[0m
[0;32m    amazon-ebs: <Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"[0m
[0;32m    amazon-ebs: +               keystoreFile="/etc/tomcat7/keystore.jks"[0m
[0;32m    amazon-ebs: +               keystorePass="iXoIDoIWJmXpO9_Qa85r"[0m
[0;32m    amazon-ebs: +               keystoreType="jks"[0m
[0;32m    amazon-ebs: +               truststorePass="iXoIDoIWJmXpO9_Qa85r"[0m
[0;32m    amazon-ebs: maxThreads="150" scheme="https" secure="true"[0m
[0;32m    amazon-ebs: clientAuth="false" sslProtocol="TLS" />[0m
[0;32m    amazon-ebs: -    -->[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: <!-- Define an AJP 1.3 Connector on port 8009 -->[0m
[0;32m    amazon-ebs: -    <!--[0m
[0;32m    amazon-ebs: -    <Connector port="8009" protocol="AJP/1.3" redirectPort="8443" />[0m
[0;32m    amazon-ebs: -    -->[0m
[0;32m    amazon-ebs: +    <Connector port="8009"[0m
[0;32m    amazon-ebs: +               protocol="AJP/1.3"[0m
[0;32m    amazon-ebs: +               tomcatAuthentication="true"[0m
[0;32m    amazon-ebs: +               redirectPort="8443" />[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: -[0m
[0;32m    amazon-ebs: <!-- An Engine represents the entry point (within Catalina) that processes[0m
[0;32m    amazon-ebs: every request.  The Engine implementation for Tomcat stand alone[0m
[0;32m    amazon-ebs: analyzes the HTTP headers included with the request, and passes them[0m
[0;32m    amazon-ebs: @@ -105,7 +108,7 @@[0m
[0;32m    amazon-ebs: <!-- You should set jvmRoute to support load-balancing via AJP ie :[0m
[0;32m    amazon-ebs: <Engine name="Catalina" defaultHost="localhost" jvmRoute="jvm1">[0m
[0;32m    amazon-ebs: -->[0m
[0;32m    amazon-ebs: -    <Engine name="Catalina" defaultHost="localhost">[0m
[0;32m    amazon-ebs: +    <Engine name="Catalina" defaultHost="localhost" >[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: <!--For clustering, please take a look at documentation at:[0m
[0;32m    amazon-ebs: /docs/cluster-howto.html  (simple how to)[0m
[0;32m    amazon-ebs: @@ -114,19 +117,26 @@[0m
[0;32m    amazon-ebs: <Cluster className="org.apache.catalina.ha.tcp.SimpleTcpCluster"/>[0m
[0;32m    amazon-ebs: -->[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: -      <!-- Use the LockOutRealm to prevent attempts to guess user passwords[0m
[0;32m    amazon-ebs: -           via a brute-force attack -->[0m
[0;32m    amazon-ebs: -      <Realm className="org.apache.catalina.realm.LockOutRealm">[0m
[0;32m    amazon-ebs: -        <!-- This Realm uses the UserDatabase configured in the global JNDI[0m
[0;32m    amazon-ebs: -             resources under the key "UserDatabase".  Any edits[0m
[0;32m    amazon-ebs: -             that are performed against this UserDatabase are immediately[0m
[0;32m    amazon-ebs: -             available for use by the Realm.  -->[0m
[0;32m    amazon-ebs: -        <Realm className="org.apache.catalina.realm.UserDatabaseRealm"[0m
[0;32m    amazon-ebs: -               resourceName="UserDatabase"/>[0m
[0;32m    amazon-ebs: -      </Realm>[0m
[0;32m    amazon-ebs: +      <!-- The request dumper valve dumps useful debugging information about[0m
[0;32m    amazon-ebs: +           the request and response data received and sent by Tomcat.[0m
[0;32m    amazon-ebs: +           Documentation at: /docs/config/valve.html -->[0m
[0;32m    amazon-ebs: +      <!--[0m
[0;32m    amazon-ebs: +      <Valve className="org.apache.catalina.valves.RequestDumperValve"/>[0m
[0;32m    amazon-ebs: +      -->[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: +      <!-- This Realm uses the UserDatabase configured in the global JNDI[0m
[0;32m    amazon-ebs: +           resources under the key "UserDatabase".  Any edits[0m
[0;32m    amazon-ebs: +           that are performed against this UserDatabase are immediately[0m
[0;32m    amazon-ebs: +           available for use by the Realm.  -->[0m
[0;32m    amazon-ebs: +      <Realm className="org.apache.catalina.realm.UserDatabaseRealm"[0m
[0;32m    amazon-ebs: +             resourceName="UserDatabase"/>[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: +      <!-- Define the default virtual host[0m
[0;32m    amazon-ebs: +           Note: XML Schema validation will not work with Xerces 2.2.[0m
[0;32m    amazon-ebs: +       -->[0m
[0;32m    amazon-ebs: <Host name="localhost"  appBase="webapps"[0m
[0;32m    amazon-ebs: -            unpackWARs="true" autoDeploy="true">[0m
[0;32m    amazon-ebs: +            unpackWARs="true" autoDeploy="true"[0m
[0;32m    amazon-ebs: +            >[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: <!-- SingleSignOn valve, share authentication between web applications[0m
[0;32m    amazon-ebs: Documentation at: /docs/config/valve.html -->[0m
[0;32m    amazon-ebs: @@ -135,11 +145,11 @@[0m
[0;32m    amazon-ebs: -->[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: <!-- Access log processes all example.[0m
[0;32m    amazon-ebs: -             Documentation at: /docs/config/valve.html[0m
[0;32m    amazon-ebs: -             Note: The pattern used is equivalent to using pattern="common" -->[0m
[0;32m    amazon-ebs: +             Documentation at: /docs/config/valve.html -->[0m
[0;32m    amazon-ebs: +        <!--[0m
[0;32m    amazon-ebs: <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"[0m
[0;32m    amazon-ebs: -               prefix="localhost_access_log." suffix=".txt"[0m
[0;32m    amazon-ebs: -               pattern="%h %l %u %t &quot;%r&quot; %s %b" />[0m
[0;32m    amazon-ebs: +               prefix="localhost_access_log." suffix=".txt" pattern="common" resolveHosts="false"/>[0m
[0;32m    amazon-ebs: +        -->[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: </Host>[0m
[0;32m    amazon-ebs: </Engine>[0m
[0;32m    amazon-ebs: - change group from 'tomcat7' to 'root'[0m
[0;32m    amazon-ebs: * template[/etc/tomcat7/logging.properties] action create[0m
[0;32m    amazon-ebs: - update content in file /etc/tomcat7/logging.properties from 35820b to d3364b[0m
[0;32m    amazon-ebs: --- /etc/tomcat7/logging.properties	2014-02-21 06:11:51.000000000 +0000[0m
[0;32m    amazon-ebs: +++ /tmp/chef-rendered-template20150319-1354-zhy6va	2015-03-19 00:29:28.524844000 +0000[0m
[0;32m    amazon-ebs: @@ -17,6 +17,8 @@[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: .handlers = 1catalina.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: +.level = INFO[0m
[0;32m    amazon-ebs: +[0m
[0;32m    amazon-ebs: ############################################################[0m
[0;32m    amazon-ebs: # Handler specific properties.[0m
[0;32m    amazon-ebs: # Describes specific configuration info for Handlers.[0m
[0;32m    amazon-ebs: @@ -40,11 +42,4 @@[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: org.apache.catalina.core.ContainerBase.[Catalina].[localhost].level = INFO[0m
[0;32m    amazon-ebs: org.apache.catalina.core.ContainerBase.[Catalina].[localhost].handlers = 2localhost.org.apache.juli.FileHandler[0m
[0;32m    amazon-ebs: -[0m
[0;32m    amazon-ebs: -# For example, set the com.xyz.foo logger to only log SEVERE[0m
[0;32m    amazon-ebs: -# messages:[0m
[0;32m    amazon-ebs: -#org.apache.catalina.startup.ContextConfig.level = FINE[0m
[0;32m    amazon-ebs: -#org.apache.catalina.startup.HostConfig.level = FINE[0m
[0;32m    amazon-ebs: -#org.apache.catalina.session.ManagerBase.level = FINE[0m
[0;32m    amazon-ebs: -#org.apache.catalina.core.AprLifecycleListener.level=FINE[0m
[0;32m    amazon-ebs: - change group from 'tomcat7' to 'root'[0m
[0;32m    amazon-ebs: * execute[Create Tomcat SSL certificate] action run[0m
[0;32m    amazon-ebs: - execute         keytool          -genkey          -keystore "/etc/tomcat7/keystore.jks"          -storepass "iXoIDoIWJmXpO9_Qa85r"          -keypass "iXoIDoIWJmXpO9_Qa85r"          -dname "cn=localhost"[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: * service[tomcat7] action start[0m
[0;32m    amazon-ebs: - start service service[tomcat7][0m
[0;32m    amazon-ebs: * execute[wait for tomcat7] action run[0m
[0;32m    amazon-ebs: - execute sleep 5[0m
[0;32m    amazon-ebs: * service[tomcat7] action enable (up to date)[0m
[0;32m    amazon-ebs: * execute[wait for tomcat7] action nothing (skipped due to action :nothing)[0m
[0;32m    amazon-ebs: Recipe: tomcat::users[0m
[0;32m    amazon-ebs: * template[/etc/tomcat7/tomcat-users.xml] action create[0m
[0;32m    amazon-ebs: - update content in file /etc/tomcat7/tomcat-users.xml from b43070 to e31fd6[0m
[0;32m    amazon-ebs: --- /etc/tomcat7/tomcat-users.xml	2014-01-25 20:13:05.000000000 +0000[0m
[0;32m    amazon-ebs: +++ /tmp/chef-rendered-template20150319-1354-1n91fbm	2015-03-19 00:30:14.547844000 +0000[0m
[0;32m    amazon-ebs: @@ -16,22 +16,8 @@[0m
[0;32m    amazon-ebs: limitations under the License.[0m
[0;32m    amazon-ebs: -->[0m
[0;32m    amazon-ebs: <tomcat-users>[0m
[0;32m    amazon-ebs: -<!--[0m
[0;32m    amazon-ebs: -  NOTE:  By default, no user is included in the "manager-gui" role required[0m
[0;32m    amazon-ebs: -  to operate the "/manager/html" web application.  If you wish to use this app,[0m
[0;32m    amazon-ebs: -  you must define such a user - the username and password are arbitrary.[0m
[0;32m    amazon-ebs: --->[0m
[0;32m    amazon-ebs: -<!--[0m
[0;32m    amazon-ebs: -  NOTE:  The sample user and role entries below are wrapped in a comment[0m
[0;32m    amazon-ebs: -  and thus are ignored when reading this file. Do not forget to remove[0m
[0;32m    amazon-ebs: -  <!.. ..> that surrounds them.[0m
[0;32m    amazon-ebs: --->[0m
[0;32m    amazon-ebs: -<!--[0m
[0;32m    amazon-ebs: -  <role rolename="tomcat"/>[0m
[0;32m    amazon-ebs: -  <role rolename="role1"/>[0m
[0;32m    amazon-ebs: -  <user username="tomcat" password="tomcat" roles="tomcat"/>[0m
[0;32m    amazon-ebs: -  <user username="both" password="tomcat" roles="tomcat,role1"/>[0m
[0;32m    amazon-ebs: -  <user username="role1" password="tomcat" roles="role1"/>[0m
[0;32m    amazon-ebs: --->[0m
[0;32m    amazon-ebs: +<role rolename="manager" />[0m
[0;32m    amazon-ebs: +<role rolename="admin" />[0m
[0;32m    amazon-ebs: +<user username="allaccess" password="supersecret" roles="manager, admin" />[0m
[0;32m    amazon-ebs: </tomcat-users>[0m
[0;32m    amazon-ebs: - change mode from '0640' to '0644'[0m
[0;32m    amazon-ebs: - change group from 'tomcat7' to 'root'[0m
[0;32m    amazon-ebs: * service[tomcat7] action restart[0m
[0;32m    amazon-ebs: - restart service service[tomcat7][0m
[0;32m    amazon-ebs: * execute[wait for tomcat7] action run[0m
[0;32m    amazon-ebs: - execute sleep 5[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs: Running handlers:[0m
[0;32m    amazon-ebs: Running handlers complete[0m
[0;32m    amazon-ebs: Chef Client finished, 17/21 resources updated in 206.950947746 seconds[0m
[0;32m    amazon-ebs:[0m
[0;32m    amazon-ebs:[0m
[1;32m==> amazon-ebs: Stopping the source instance...[0m
[1;32m==> amazon-ebs: Waiting for the instance to stop...[0m
[1;32m==> amazon-ebs: Creating the AMI: packer-example 1426724716[0m
[0;32m    amazon-ebs: AMI: ami-3e8ea356[0m
[1;32m==> amazon-ebs: Waiting for AMI to become ready...[0m
[1;32m==> amazon-ebs: Terminating the source AWS instance...[0m
[1;32m==> amazon-ebs: Deleting temporary security group...[0m
[1;32m==> amazon-ebs: Deleting temporary keypair...[0m
[1;32mBuild 'amazon-ebs' finished.[0m

==> Builds finished. The artifacts of successful builds are:
--> amazon-ebs: AMIs were created:

us-east-1: ami-3e8ea356
